(defx amb
    e xs
  (control amb res
    (rec loop (xs xs)
      (if
       (= xs ()) :amb/fail
       (let (r (prompt amb (res (eval e (car xs)))))
         (if
          (= r :amb/fail) (prompt amb (loop (cdr xs)))
          r))))))
